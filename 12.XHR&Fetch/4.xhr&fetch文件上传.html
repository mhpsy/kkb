<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Title</title>
</head>
<body>

<form class="fileform">
  <input class="file" type="file">
</form>
<button class="upload">上传</button>

<script>
  const fileEl = document.querySelector(".file")
  const uploadBtn = document.querySelector(".upload")

  // uploadBtn.onclick = function () {
  //   // 1.获取文件
  //   const files = fileEl.files
  //   if (!files.length) {
  //     alert("请选择要上传的文件")
  //     return
  //   }
  //   const avatarFile = files[0]
  //   const fileForm = new FormData()
  //   fileForm.append("avatar", avatarFile)
  //
  //   // 2.开始上传
  //   const xhr = new XMLHttpRequest()
  //   xhr.upload.onprogress = function (event) {
       //可以查看上传的进度
  //     console.log(`${event.loaded}/${event.total}`)
  //   }
  //   xhr.onload = function () {
  //     console.log(xhr.response)
  //   }
  //   xhr.open("POST", "http://192.168.0.110:1888/02_param/upload")
  //   xhr.setRequestHeader("Content-Type", "multipart/form-data")
  //   xhr.send(fileForm)
  // }

  //fetch

  uploadBtn.onclick = function () {
    // 1.获取文件
    const files = fileEl.files
    if (!files.length) {
      alert("请选择要上传的文件")
      return
    }
    const avatarFile = files[0]
    const fileForm = new FormData()
    fileForm.append("avatar", avatarFile)

    // 2.开始上传
    fetch("http://123.207.32.32:1888/02_param/upload", {
      method: "post",
      body: fileForm
    }).then(res => {
      return res.json()
    }).then(res => {
      console.log("res:", res)
    })
  }


</script>
</body>
</html>
